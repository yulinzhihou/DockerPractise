## 全新一键架设环境开服食用指南

- #### 先装一个最新的centos7.x系统，64位。安装过程不进行演示，安装完成后执行以下几条命令。

```shell
# step 1: 安装必要的一些系统工具
sudo yum install -y yum-utils device-mapper-persistent-data lvm2
# Step 2: 添加软件源信息
sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
# Step 3: 更新并安装Docker-CE
sudo yum makecache fast
sudo yum -y install docker-ce
# Step 4: 开启Docker服务
sudo service docker start
# step 5: 更新系统组件并重启
yum -y update && yum -y install git vim && reboot
# step 6: 等待重启完成后，再执行
cd ~
git clone https://github.com/yulinzhihou/docker_tlsf.git
# step 7:等项目下载完成后。
chmod -R 777 docker_tlsf && cd ~/docker_tlsf
# step 8:执行部署命令
docker-compser up -d
```

- #### 服务端配置

```SHELl
# step 1 : 准备好服务端压缩包文件 tlbb.tar.gz
tar zxf tlbb.tar.gz -C /DockerTLBB/workspace && chmod -R 777 /DockerTLBB/workspace
# step 2 : 开启验证
cd ~/docker_tlsf/scripts && ./ssh-game_server.sh
cd ../billing && ./billing &
# step 3 : 开服
cd ~/docker_tlsf/scripts && ./ssh-game_server.sh
./run.sh
# 或者使用分部方式进行调试
cd ~/docker_tlsf/scripts && ./ssh-game_server.sh
cd Server/ && ./shm start
cd Server && ./Login
cd Server && ./World
cd Server && ./Server
# step 4 ：至此服务端环境全部搭建完成，loginPort 13580 gamePort 15680
# 配置登录器，或者单机登录即可
```

- ### 换端命令

```shell
# step 1 : 关闭并且删除容器
docker stop tlsf_game_server_1 && docker rm tlsf_game_server_1 && docker stop tlsf_webdb_1 && docker rm tlsf_webdb_1 && docker stop tlsf_tlbbdb_1 && docker rm tlsf_tlbbdb_1
# step 2 : 上传服务端文件，解压并给相应权限
tar zxf tlbb.tar.gz -C /DockerTLBB/workspace && chown -R root:root tlbb && chmod -R 777 /DockerTLBB/workspace
# step 3 ： 将上一版本的服务端备份，改名。
cd /DockerTLBB/workspace
\cp -rf tlbb-xyj/Server/Config/ServerInfo.ini tlbb/Server/Config
\cp -rf tlbb-xyj/Server/Config/ShareMemInfo.ini tlbb/Server/Config
\cp -rf tlbb-xyj/Server/Config/LoginInfo.ini tlbb/Server/Config
# step 4 : 运行容器环境
cd /back/tlsf && docker-compose up -d
# step 5 : 开服命令走一波，如果是测试不确定的残端，建议先使用分开开服的命令进行，以查明是否有报错
# 打开窗口1
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd ../billing && ./billing &
# 打开窗口2
cd /back/tlsf/scripts && ./ssh-game_server.sh
./run.sh

# 或者使用分部方式进行调试
# 打开窗口1
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd ../billing && ./billing &
# 打开窗口2
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd Server && ./shm start
# 打开窗口3
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd Server && ./Login
# 打开窗口4
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd Server&& ./World
# 打开窗口5
cd /back/tlsf/scripts && ./ssh-game_server.sh
cd Server && ./Server
```



